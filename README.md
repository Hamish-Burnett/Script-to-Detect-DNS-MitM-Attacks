# Script-to-Detect-DNS-MitM-Attacks
A Python script has been developed to detect DNS Man in the Middle (MitM) attacks, in packet captures. The script uses Scapy to work with Packet Capture files (PCAP files), which can be obtained through WireShark. This script is useful for cyber security professionals, who may be investigating cyber attacks. This script automates the process of analysing web traffic, to determine the source of an attack. Please note, this script currently only detects DNS MitM attacks.
A DNS MitM attack is where an attacker injects a DNS packet into the web traffic, to redirect a person to a malicious site, instead of to the intended website.
The script works by checking whether there are duplicate DNS responses with the same DNS ID. The script then compiles the duplicate DNS responses into a List, which is printed to the screen. The investigator can then use the script to further investigate malicious packets that may indicate a DNS MitM attack. The packets identified using this script, can also be analysed during further investigations using other tools, such as Wireshark, and Tshark.

The idea for this project, came from taking a university subject involved with investigating cyber attacks. In this subject, one of the tasks required analysis of a packet capture, that was found to contain a DNS MitM attack. This analysis was completed manually, without any scripting automation. I then decided to develop a script in my spare time to automate this task, both to learn more about cyber attacks, and to develop my cyber security scripting skills.

To use this script, install Python, install the Scapy library, and download the code for this project. Update the filepath in the code to the PCAP file you wish to analyse, and run the program. I am currently using the program Spyder, accessed through the Anaconda application. On Spyder, I am running Python 3.9.
